version: '3.8'

services:
  grabid-backend:
    build:
      context: ./grabid-backend
    container_name: grabid-backend
    environment:
      - PORT=8080
      - GRAB_SECRET=${GRAB_SECRET}
      - GRAB_MAX_SIZE=${GRAB_MAX_SIZE:-1GB}
      - GRAB_MAX_CONCURRENT=${GRAB_MAX_CONCURRENT:-5}
      - GRAB_RATE_LIMIT=${GRAB_RATE_LIMIT:-1-5}
    restart: unless-stopped
    networks:
      - grabid-net

  grabid-frontend:
    build:
      context: ./grabid-frontend
    container_name: grabid-frontend
    ports:
      - "80:80"
    restart: unless-stopped
    depends_on:
      - grabid-backend
    networks:
      - grabid-net

networks:
  grabid-net:
    driver: bridge
